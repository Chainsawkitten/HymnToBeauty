<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Hymn to Beauty: Scripting</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Hymn to Beauty
   </div>
   <div id="projectbrief">C++ 3D Engine</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('_your_first_hymn__scripting.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Scripting </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >You have now created a 3D scene. Let's test playing it. To test a scene, press F5.</p>
<div class="image">
<img src="PlayScene.png" alt=""/>
</div>
<p >Currently, the hymn consists of a camera facing a wall. Not the most exciting. We could move the player entity in the scene to get a more exciting location, but even more exciting would be allowing the player to control the camera. This is done through scripting.</p>
<p >To stop playing and return to the editor, press F5 again.</p>
<h1><a class="anchor" id="CreateScript"></a>
Creating a script</h1>
<p >To create a new script, right click on the <code>Resources</code> folder in the resources list and select <code>Add script</code>.</p>
<div class="image">
<img src="AddScript.png" alt=""/>
</div>
<p >A new script will be created. Click on it. A window will open allowing you to edit the script.</p>
<div class="image">
<img src="ScriptEditor.png" alt=""/>
</div>
<p >For now let's rename the script to something more descriptive. In the textfield enter <code>FirstPersonController</code> and press Enter.</p>
<h1><a class="anchor" id="ConfiguringTextEditor"></a>
Configuring the text editor</h1>
<p >Currently, if you press the <code>Edit Script</code> button nothing will happen. This is because Hymn to Beauty does not contain a text editor to edit scripts. Instead, you will use whatever editor you prefer. <a href="https://notepad-plus-plus.org/">Notepad++</a> or <a href="https://code.visualstudio.com/">Visual Studio Code</a> are good options but any text editor will do. When you press the <code>Edit Script</code> button, Hymn to Beauty will open the script in your text editor of choice. But before it can do that, you need to tell it what text editor to use. Close Hymn to Beauty.</p>
<h2>Windows</h2>
<p >Open <code>%APPDATA%\Hymn to Beauty\Settings.ini</code> in a text editor. In the <code>[Scripts]</code> section there is an entry called <code>Text Editor</code>. Set this entry to the full path to the text editor, for example: </p><pre class="fragment">[Script]
Text Editor = C:\Program Files\Notepad++\notepad++.exe
</pre> <h2>Mac and Linux</h2>
<p >Opening an external text editor directly from Hymn to Beauty is currently not supported on Mac and Linux. Instead, you will have to open the scripts manually from the hymn's resource folder.</p>
<h1><a class="anchor" id="EditingScript"></a>
Editing a script</h1>
<p >Open Hymn to Beauty, open the script and click on <code>Edit Script</code>. If you configured the path to the text editor correctly, your script will now open in your text editor (Windows only).</p>
<h1><a class="anchor" id="ExampleScripting"></a>
Understanding the example script</h1>
<p >When you created a new script, an example script was created. </p><pre class="fragment">class Default {
    Hub @hub;
    Entity @self;

    Default(Entity @entity){
        @hub = Managers();
        @self = @entity;

        // Remove this if updates are not desired.
        RegisterUpdate();
    }

    // Called by the engine for each frame.
    void Update(float deltaTime) {

    }
}
</pre><p> This scripts defines a new class. The class name has to be the same as the name of the script, in this case <code>FirstPersonController</code>. But currently it is <code>Default</code>, so change all instances of <code>Default</code> to <code>FirstPersonController</code>. Now let's break down what the script does, bit by bit. </p><pre class="fragment">class FirstPersonController {
    ...
}
</pre><p> This defines the class, all its methods and properties. </p><pre class="fragment">    Hub @hub;
    Entity @self;
</pre><p> This are member variables. The <code>@</code> means that they are references. </p><pre class="fragment">    FirstPersonController(Entity @entity){
        ...
    }
</pre><p> This is the constructor. This method will be called when the entity that the script is attached to is created. This is the only method that the engine will call. If you want to get other calls from the engine (such as an Update function called every frame) they have to be registered.</p>
<p >The <code>@entity</code> parameter is the entity to which the script is attached. </p><pre class="fragment">        @hub = Managers();
</pre><p> This gets the manager hub. From this hub, you can access the managers, such as the debug drawing manager or the physics manager. We won't use those in this script. </p><pre class="fragment">        @self = @entity;
</pre><p> This stores the entity into a member variable so that we can use it later. </p><pre class="fragment">        // Remove this if updates are not desired.
        RegisterUpdate();
</pre><p> This tells Hymn to Beauty that we want to have our Update method called every frame. </p><pre class="fragment">    // Called by the engine for each frame.
    void Update(float deltaTime) {

    }
</pre><p> This is the update method. If it has been registered through <code>RegisterUpdate</code>, it will be called every frame. This is where we can write our game logic.</p>
<p >The <code>deltaTime</code> parameter is the time elapsed since the last frame in seconds. Whenever you move anything in the update function, you should always multiply the speed with the delta time to keep the movement consistent regardless of the frame rate. Otherwise the game will move at different speeds depending on whether it's rendering at 60 fps, 30 fps or something else.</p>
<p >For now, to test it out, let's just move the entity along the x-axis. </p><pre class="fragment">    void Update(float deltaTime) {
        self.position.x += deltaTime;
    }
</pre> <h1><a class="anchor" id="BuildScript"></a>
Building a script</h1>
<p >Whenever you play the hymn, all scripts will be built automatically, so there is no need to build scripts manually. However, doing so can be useful as it can tell you whether a specific script can be built successfully or has errors in it. To test build a script, click the <code>Build Script</code> button. The button will turn green if the script built successfully.</p>
<div class="image">
<img src="BuildScriptSuccess.png" alt=""/>
</div>
<p >If the script caused an error, the button will be red. You need to fix the error and then try again.</p>
<div class="image">
<img src="BuildScriptFail.png" alt=""/>
</div>
<h1><a class="anchor" id="AssignScript"></a>
Assigning a script to an entity</h1>
<p >Like all other functionality, entities gain scripting functionality through a component: the Script component. Open the scene and edit the Player entity.</p>
<p >Add a Script component by clicking <code>Add component</code> and selecting <code>Script</code>.</p>
<div class="image">
<img src="AddScriptComponent.png" alt=""/>
</div>
<p >In the script component, click the <code>Select script</code> button and select the first person controller script.</p>
<div class="image">
<img src="SelectScript.png" alt=""/>
</div>
<p >Test the scene again by pressing F5. The camera will now be moving to the right. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">Hymn to Beauty</a></li><li class="navelem"><a class="el" href="_getting_started.html">Getting Started</a></li><li class="navelem"><a class="el" href="_your_first_hymn.html">Your First Hymn</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
</body>
</html>
